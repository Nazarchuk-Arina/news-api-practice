{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/news-api/config.js","../src/js/news-api/news-service.js","../src/js/helpers/truncateText.js","../src/js/helpers/appendNewsMarkup.js","../src/js/index.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('.js-search-form'),\n  container: document.querySelector('.js-cards-container'),\n  loadMoreBtn: document.querySelector('.js-load-more'),\n  loader: document.querySelector('.js-loader'),\n};\n","export const BASE_URL = 'https://newsapi.org/v2/';\nexport const API_KEY = 'd3b04eae47fa4b599491b479582b7d24';\nexport const PER_PAGE = 6;\n","import axios from 'axios';\nimport { BASE_URL, API_KEY, PER_PAGE } from './config.js';\n\nexport async function fetchNews(searchQuery, currentPage = 1) {\n  const options = new URLSearchParams({\n    q: searchQuery,\n    apiKey: API_KEY,\n    pageSize: PER_PAGE,\n    page: currentPage,\n    language: 'en',\n  });\n  const url = `${BASE_URL}/everything?${options}`;\n\n  const {\n    data: { articles, totalResults, status, message = '' },\n  } = await axios.get(url);\n\n  if (status !== 'ok') {\n    throw new Error('message');\n  }\n\n  if (articles.length === 0) {\n    throw new Error('No articles found');\n  }\n\n  return { articles, totalResults };\n}\n","export function truncate(text, symbolLimit = 90) {\n  if (!text) {\n    return text;\n  }\n  return text.length <= symbolLimit\n    ? text\n    : `${text.slice(0, symbolLimit - 3) + '...'}`;\n}\n","import { truncate } from './truncateText';\n\nexport function appendNewsArticles(articles, wrapper) {\n  const articlesMarkup = articles\n    .map(\n      ({\n        title,\n        description,\n        url,\n        urlToImage,\n        publishedAt,\n      }) => `<article class=\"card\">\n        <img\n          class=\"card-img-top\"\n          src=\"${\n            urlToImage\n              ? urlToImage\n              : 'https://placehold.co/600x400?text=Hot news'\n          }\"\n          alt=\"${title}\"\n        />\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">${truncate(title, 40)}</h5>\n          <p class=\"card-text\">${truncate(description)}</p>\n          <p class=\"card-text\">\n            <small class=\"text-body-secondary\">${publishedAt}</small>\n          </p>\n          <a href=\"${url}\" class=\"btn btn-outline-primary\" target=\"_blank\" rel=\"noopener noreferrer\">Read more</a>\n        </div>\n      </article>`\n    )\n    .join('');\n\n  wrapper.insertAdjacentHTML('beforeend', articlesMarkup);\n}\n","import { refs } from './refs';\nimport { fetchNews } from './news-api/news-service';\nimport { appendNewsArticles } from './helpers/appendNewsMarkup';\nimport { PER_PAGE } from './news-api/config';\nimport izitoast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentPage = 1;\nlet searchQuery = null;\nlet pages = 0;\n\nrefs.form.addEventListener('submit', handleSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore);\n// fetchNews();\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  searchQuery = form.elements.newsKeyword.value;\n  refs.container.innerHTML = '';\n  currentPage = 1;\n\n  try {\n    const { articles, totalResults } = await fetchNews(\n      searchQuery,\n      currentPage\n    );\n    pages = Math.ceil(totalResults / PER_PAGE);\n    appendNewsArticles(articles, refs.container);\n    refs.loadMoreBtn.classList.remove('is-hidden');\n  } catch (error) {\n    console.log(error);\n    refs.loadMoreBtn.classList.add('is-hidden');\n    IziToast.error({ message: error.message });\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handleLoadMore(event) {\n  currentPage += 1;\n\n  try {\n    refs.loader.classList.remove('is-hidden');\n    const { articles } = await fetchNews(searchQuery, currentPage);\n    appendNewsArticles(articles, refs.container);\n    handleScrollView();\n\n    if (currentPage >= Math.min(pages, 16)) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      IziToast.success({ message: 'It is last page' });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    refs.loader.classList.add('is-hidden');\n  }\n}\n\nfunction handleScrollView() {\n  const lastArticle = refs.container.lastElementChild;\n  const articleHeight = lastArticle.getBoundingClientRect().height;\n  const scrollHeight = articleHeight * 2;\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["refs","BASE_URL","API_KEY","PER_PAGE","fetchNews","searchQuery","currentPage","options","url","articles","totalResults","status","message","axios","truncate","text","symbolLimit","appendNewsArticles","wrapper","articlesMarkup","title","description","urlToImage","publishedAt","pages","handleSubmit","handleLoadMore","event","form","error","handleScrollView","scrollHeight"],"mappings":"svBAAO,MAAMA,EAAO,CAClB,KAAM,SAAS,cAAc,iBAAiB,EAC9C,UAAW,SAAS,cAAc,qBAAqB,EACvD,YAAa,SAAS,cAAc,eAAe,EACnD,OAAQ,SAAS,cAAc,YAAY,CAC7C,ECLaC,EAAW,0BACXC,EAAU,mCACVC,EAAW,ECCjB,eAAeC,EAAUC,EAAaC,EAAc,EAAG,CAC5D,MAAMC,EAAU,IAAI,gBAAgB,CAClC,EAAGF,EACH,OAAQH,EACR,SAAUC,EACV,KAAMG,EACN,SAAU,IACd,CAAG,EACKE,EAAM,GAAGP,CAAQ,eAAeM,CAAO,GAEvC,CACJ,KAAM,CAAE,SAAAE,EAAU,aAAAC,EAAc,OAAAC,EAAQ,QAAAC,EAAU,EAAI,CACvD,EAAG,MAAMC,EAAM,IAAIL,CAAG,EAEvB,GAAIG,IAAW,KACb,MAAM,IAAI,MAAM,SAAS,EAG3B,GAAIF,EAAS,SAAW,EACtB,MAAM,IAAI,MAAM,mBAAmB,EAGrC,MAAO,CAAE,SAAAA,EAAU,aAAAC,EACrB,CC1BO,SAASI,EAASC,EAAMC,EAAc,GAAI,CAC/C,OAAKD,IAGEA,EAAK,QAAUC,EAClBD,EACA,GAAGA,EAAK,MAAM,EAAGC,EAAc,CAAC,EAAI,KAAK,GAC/C,CCLO,SAASC,EAAmBR,EAAUS,EAAS,CACpD,MAAMC,EAAiBV,EACpB,IACC,CAAC,CACC,MAAAW,EACA,YAAAC,EACA,IAAAb,EACA,WAAAc,EACA,YAAAC,CACR,IAAY;AAAA;AAAA;AAAA,iBAIAD,GAEI,4CACL;AAAA,iBACMF,CAAK;AAAA;AAAA;AAAA,mCAGaN,EAASM,EAAO,EAAE,CAAC;AAAA,iCACrBN,EAASO,CAAW,CAAC;AAAA;AAAA,iDAELE,CAAW;AAAA;AAAA,qBAEvCf,CAAG;AAAA;AAAA,iBAGnB,EACA,KAAK,EAAE,EAEVU,EAAQ,mBAAmB,YAAaC,CAAc,CACxD,CC3BA,IAAIb,EAAc,EACdD,EAAc,KACdmB,EAAQ,EAEZxB,EAAK,KAAK,iBAAiB,SAAUyB,CAAY,EACjDzB,EAAK,YAAY,iBAAiB,QAAS0B,CAAc,EAGzD,eAAeD,EAAaE,EAAO,CACjCA,EAAM,eAAc,EAEpB,MAAMC,EAAOD,EAAM,cACnBtB,EAAcuB,EAAK,SAAS,YAAY,MACxC5B,EAAK,UAAU,UAAY,GAC3BM,EAAc,EAEd,GAAI,CACF,KAAM,CAAE,SAAAG,EAAU,aAAAC,CAAc,EAAG,MAAMN,EACvCC,EACAC,CACN,EACIkB,EAAQ,KAAK,KAAKd,EAAeP,CAAQ,EACzCc,EAAmBR,EAAUT,EAAK,SAAS,EAC3CA,EAAK,YAAY,UAAU,OAAO,WAAW,CAC9C,OAAQ6B,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjB7B,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1C,SAAS,MAAM,CAAE,QAAS6B,EAAM,OAAS,CAAA,CAC7C,QAAY,CACRD,EAAK,MAAK,CACX,CACH,CAEA,eAAeF,EAAeC,EAAO,CACnCrB,GAAe,EAEf,GAAI,CACFN,EAAK,OAAO,UAAU,OAAO,WAAW,EACxC,KAAM,CAAE,SAAAS,CAAQ,EAAK,MAAML,EAAUC,EAAaC,CAAW,EAC7DW,EAAmBR,EAAUT,EAAK,SAAS,EAC3C8B,IAEIxB,GAAe,KAAK,IAAIkB,EAAO,EAAE,IACnCxB,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1C,SAAS,QAAQ,CAAE,QAAS,iBAAmB,CAAA,EAElD,OAAQ6B,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACR7B,EAAK,OAAO,UAAU,IAAI,WAAW,CACtC,CACH,CAEA,SAAS8B,GAAmB,CAG1B,MAAMC,EAFc/B,EAAK,UAAU,iBACD,sBAAqB,EAAG,OACrB,EACrC,OAAO,SAAS,CACd,IAAK+B,EACL,KAAM,EACN,SAAU,QACd,CAAG,CACH"}